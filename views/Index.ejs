<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no" />
    
    <title><%=title %></title>

    <style>
      
      #viewDiv {
        padding: 0;
        margin: auto;
        height: 600px;
        width: 900px;
      }
    </style>
    <script src="/ajax.js"></script>
    <script src="/controller.js"></script>
    <link rel="stylesheet" href="https://js.arcgis.com/4.23/esri/themes/light/main.css">
    <script src="https://js.arcgis.com/4.23/"></script>
    <script src="/map-service.js"></script>
    <link rel="stylesheet" href="/css/style.css">
    <script type="text/javascript">
       require(["esri/config","esri/Map", "esri/views/SceneView","esri/Graphic","esri/layers/GraphicsLayer",], function (esriConfig,Map, MapView, Graphic, GraphicsLayer) {

      esriConfig.apiKey = "AAPKde6378fdc0564c52bf3c878d29ca7e9bqt_7Tkm-7uQIlD5yN-lHJCppLGbCIwYVq8HxdhA731ilXNtW3Dth2ATZhGwQpv9D";

      const map = new Map({
      basemap: "satellite",
      });

      const view = new MapView({
      map: map,
      center: [-5.0020482,33.9899339], // Longitude, latitude
      zoom: 14, // Zoom level
      container: "viewDiv", // Div element
      });
      let graphicsLayer;
      graphicsLayer = new GraphicsLayer();
      map.add(graphicsLayer);

        '<% for(var i=0;i<places.length;i++){ %>'
            var place = {
                id : '<%-places[i]._id%>',
                name : '<%-places[i].name%>',
                longitude : '<%-places[i].longitude%>',
                latitude : '<%-places[i].latitude%>',
                description : '<%-places[i].description%>',
                image : '<%-places[i].image%>',
            }
            addMarker(graphicsLayer,place,Graphic);
        '<%}%>'
        
        GlobalInformation(view,graphicsLayer);
        detailInfo(graphicsLayer,view,Graphic);
        zoomOn(view)
      });


    </script>
      
  </head>
  <body onload="loadEstab();">
    <nav>
      <h2>Schools Map</h2>
      <div>
        <label for="estab" id="hh">Establishment : </label>
        <select name="estab" id="estab">
          <option value="">--Select an Establishment--</option>
        </select>
      </div>
      

      <ul>
        <li><a href="#">Establishments</a></li>
        <li><a href="#">Locaux</a></li>
        <li><a href="#">Deconnecter</a></li>
      </ul>
    </nav>
    <div id="viewDiv"></div>
  </body>
</html>